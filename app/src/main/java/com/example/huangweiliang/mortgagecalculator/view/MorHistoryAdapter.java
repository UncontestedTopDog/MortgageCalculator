package com.example.huangweiliang.mortgagecalculator.view;import android.content.Intent;import android.support.v7.widget.RecyclerView;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.TextView;import com.example.huangweiliang.mortgagecalculator.R;import com.example.huangweiliang.mortgagecalculator.SharedObjects;import com.example.huangweiliang.mortgagecalculator.activity.MorResultActivity;import com.example.huangweiliang.mortgagecalculator.model.MorHistoryData;import com.example.huangweiliang.mortgagecalculator.model.MortgageData;import com.example.huangweiliang.mortgagecalculator.model.ResultData;import java.util.ArrayList;import java.util.List;public class MorHistoryAdapter extends RecyclerView.Adapter<MorHistoryAdapter.MorHistoryViewHolder>{    private List<MorHistoryData> morHistoryDatas = new ArrayList<>();    public void setMorHistoryDatas(List<MorHistoryData> morHistoryDatas) {        this.morHistoryDatas = morHistoryDatas;    }    @Override    public MorHistoryViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.mor_history_item,parent,false);        return new MorHistoryViewHolder(view);    }    @Override    public void onBindViewHolder(MorHistoryViewHolder holder, int position) {        holder.time.setText(morHistoryDatas.get(position).getId() + "");        holder.comLoan.setText(String.format("%.2f万", morHistoryDatas.get(position).getComLoan()/10000));        holder.fundLoan.setText(String.format("%.2f万", morHistoryDatas.get(position).getFundLoan()/10000));        holder.repayment.setText(String.format("%.1f年", morHistoryDatas.get(position).getRepayment() / 12.0));        String repaymentType = "等额本金";        switch (morHistoryDatas.get(position).getRepaymentType()) {            case MortgageData.REPAYMENT_AC:                repaymentType = "等额本息";                break;            case MortgageData.REPAYMENT_ACPI:                repaymentType = "等额本金";                break;        }        holder.repayType.setText(String.valueOf(repaymentType));        MortgageData mortgageData = new MortgageData(morHistoryDatas.get(position).mortgageType,morHistoryDatas.get(position).repaymentType,                morHistoryDatas.get(position).getComLoan(),morHistoryDatas.get(position).getComRate(),morHistoryDatas.get(position).getFundLoan(),                morHistoryDatas.get(position).getFundRate(),morHistoryDatas.get(position).getRepayment());        final ResultData[][] resultDatas = mortgageData.calculator();        String[] results = compute(resultDatas);        holder.eachPay.setText(results[0]);        holder.eachDecrease.setText(results[1]);        holder.allInterest.setText(results[3]);        holder.allPay.setText(results[4]);        holder.itemView.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(SharedObjects.INSTANCES.getCurrentActivity(), MorResultActivity.class);                intent.putExtra(MortgageData.RESULTDATA, resultDatas);                SharedObjects.INSTANCES.getCurrentActivity().startActivity(intent);            }        });    }    private double getAllInterest(ResultData[] resultDatas){        double interest = 0 ;        for (ResultData resultData: resultDatas){            interest+=resultData.getInterest();        }        return (interest/10000);    }    private double getAllPay(ResultData[] resultDatas) {        double pay = 0;        for (ResultData resultData : resultDatas) {            pay += resultData.getPay();        }        return (pay/10000);    }    public String[] compute(ResultData[][] resultDatas){        String[] results = new String[5];        results[0] = String.format("%.2f", resultDatas[0][0].getPay() + resultDatas[1][0].getPay());        results[1] = String.format("%.2f元",                resultDatas[0][0].getPay() + resultDatas[1][0].getPay()                        - resultDatas[0][1].getPay() - resultDatas[1][1].getPay());        results[2] = String.valueOf(resultDatas[0].length);        results[3] = String.format("%.2f万元",getAllInterest(resultDatas[0])+getAllInterest(resultDatas[1]));        results[4] = String.format("%.2f万元",getAllPay(resultDatas[0])+getAllPay(resultDatas[1]));        return results;    }    @Override    public int getItemCount() {        return morHistoryDatas.size();    }    public class MorHistoryViewHolder extends RecyclerView.ViewHolder{        private TextView time;        private TextView comLoan;        private TextView fundLoan;        private TextView repayment;        private TextView repayType;        private TextView eachPay;        private TextView allInterest;        private TextView allPay;        private TextView eachDecrease;        public MorHistoryViewHolder(View itemView) {            super(itemView);            time = (TextView) itemView.findViewById(R.id.time);            comLoan = (TextView) itemView.findViewById(R.id.com_loan);            fundLoan = (TextView) itemView.findViewById(R.id.fund_loan);            repayment = (TextView) itemView.findViewById(R.id.repayment);            repayType = (TextView) itemView.findViewById(R.id.repayment_type);            eachPay = (TextView) itemView.findViewById(R.id.each_pay);            allInterest = (TextView) itemView.findViewById(R.id.all_interest);            allPay = (TextView) itemView.findViewById(R.id.all_pay);            eachDecrease = (TextView) itemView.findViewById(R.id.each_decrease);        }    }}