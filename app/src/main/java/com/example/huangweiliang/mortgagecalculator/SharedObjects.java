package com.example.huangweiliang.mortgagecalculator;import android.app.Activity;import android.app.Application;import android.database.sqlite.SQLiteDatabase;import android.os.Bundle;import android.support.annotation.NonNull;import android.util.Log;import com.greendao.gen.DaoMaster;import com.greendao.gen.DaoSession;import java.lang.ref.WeakReference;public enum SharedObjects {    INSTANCES;    private static final String TAG = "TApp:SharedObjects";    private WeakReference<Activity> currentActivity;    private Application app;    int mActivitiesCount = 0;    private DaoMaster.DevOpenHelper helper ;    private SQLiteDatabase db ;    private DaoMaster daoMaster;    private DaoSession daoSession ;    SharedObjects() {    }    public void init(@NonNull Application app){        this.app = app;        app.registerActivityLifecycleCallbacks(new Application.ActivityLifecycleCallbacks() {            @Override            public void onActivityCreated(Activity activity, Bundle savedInstanceState) {                Log.i(TAG, String.format("onActivityCreated: %s", activity.getComponentName()));                ++mActivitiesCount;            }            @Override            public void onActivityStarted(Activity activity) {            }            @Override            public void onActivityResumed(Activity activity) {                Log.i(TAG, String.format("onActivityResumed: %s", activity.getComponentName()));                currentActivity = new WeakReference<>(activity);            }            @Override            public void onActivityPaused(Activity activity) {                Log.i(TAG, String.format("onActivityPaused: %s", activity.getComponentName()));                currentActivity = null;            }            @Override            public void onActivityStopped(Activity activity) {            }            @Override            public void onActivitySaveInstanceState(Activity activity, Bundle outState) {            }            @Override            public void onActivityDestroyed(final Activity activity) {                Log.i(TAG, String.format("onActivityDestroyed: %s", activity.getComponentName()));                --mActivitiesCount;            }        });        setDatabase(app);    }    private void setDatabase(@NonNull Application app) {        helper = new DaoMaster.DevOpenHelper(app,"mortgage-db");        db = helper.getWritableDatabase();        daoMaster = new DaoMaster(db);        daoSession = daoMaster.newSession();    }    public DaoSession getDaoSession() {        return daoSession;    }    public SQLiteDatabase getDb() {        return db;    }    public Activity getCurrentActivity() {        return currentActivity == null ? null : currentActivity.get();    }}